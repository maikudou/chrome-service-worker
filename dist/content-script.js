(()=>{"use strict";var e;!function(e){e.isWelcomeMessage=function(e){return"welcome"===e.type},e.isPongMessage=function(e){return"pong"===e.type},e.isSocketMessage=function(e){return"socket"===e.type},e.isMirrorMessage=function(e){return"mirror"===e.type},e.isStartSessionMessage=function(e){return"startSession"===e.type},e.isPingMessage=function(e){return"ping"===e.type},e.isSocketSendMessage=function(e){return"socketSend"===e.type}}(e||(e={})),console.log("I am a content script");let o,s,n=5,t=Date.now();const r=function(){try{o=chrome.runtime.connect({name:"sw-connection"}),o.onDisconnect.addListener((()=>{console.log(`Worker disconnected. TTL: ${(Date.now()-t)/1e3}s`,`Error: ${chrome.runtime.lastError}`),n-- >=0&&r()})),o.onMessage.addListener((o=>{const s=JSON.parse(o);s&&function(o){e.isMirrorMessage(o)?console.log(`Recieved mirrored message: ${o.message}`):e.isPongMessage(o)?console.log("Recieved pong message"):e.isSocketMessage(o)?console.log(`Recieved message from socket: ${o.data}`):e.isWelcomeMessage(o)&&console.log("Recieved Welcome message")}(s)})),window.setTimeout((()=>{n=5}),5e3),console.log("Connected to Service Worker",(Date.now()-t)/1e3),t=Date.now(),a(o,{type:"startSession"}),i(o,1500),c(o)}catch(e){}};function c(e){s=window.setTimeout((()=>{a(o,{type:"ping"}),c(e)}),1e4+1e4*Math.random())}function i(e,n){s=window.setTimeout((()=>{a(o,{type:"socketSend",message:`Sorry, current time is ${Date.now()}`}),i(e)}),n||3e4+3e4*Math.random())}function a(e,o){try{e.postMessage(JSON.stringify(o))}catch(e){throw console.log(`Couldn't post message do to error: ${e}`),e}}r()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jaHJvbWUtc2VydmljZS13b3JrZXIvLi9zcmMvdHlwZXMudHMiLCJ3ZWJwYWNrOi8vY2hyb21lLXNlcnZpY2Utd29ya2VyLy4vc3JjL2NvbnRlbnQtc2NyaXB0LnRzIl0sIm5hbWVzIjpbIk1lc3NhZ2UiLCJpc1dlbGNvbWVNZXNzYWdlIiwibWVzc2FnZSIsInR5cGUiLCJpc1BvbmdNZXNzYWdlIiwiaXNTb2NrZXRNZXNzYWdlIiwiaXNNaXJyb3JNZXNzYWdlIiwiaXNTdGFydFNlc3Npb25NZXNzYWdlIiwiaXNQaW5nTWVzc2FnZSIsImlzU29ja2V0U2VuZE1lc3NhZ2UiLCJjb25zb2xlIiwibG9nIiwiY29ubmVjdGlvbiIsInBpbmdUaW1lb3V0IiwicmVjb25uZWN0c0xlZnQiLCJsYXN0VGltZUNvbm5lY3RlZCIsIkRhdGUiLCJub3ciLCJjb25uZWN0VG9TZXJ2aWNlV29ya2VyIiwiY2hyb21lIiwicnVudGltZSIsImNvbm5lY3QiLCJuYW1lIiwib25EaXNjb25uZWN0IiwiYWRkTGlzdGVuZXIiLCJsYXN0RXJyb3IiLCJvbk1lc3NhZ2UiLCJwYXJzZWRNZXNzYWdlIiwiSlNPTiIsInBhcnNlIiwiZGF0YSIsInByb2Nlc3NQb3J0TWVzc2FnZSIsIndpbmRvdyIsInNldFRpbWVvdXQiLCJwb3N0TWVzc2FnZVRvU2VydmljZVdvcmtlciIsInNvY2tldFBpbmciLCJwaW5nIiwiXyIsInBvcnQiLCJNYXRoIiwicmFuZG9tIiwidGltZW91dCIsInBvc3RNZXNzYWdlIiwic3RyaW5naWZ5IiwiZSJdLCJtYXBwaW5ncyI6Im1CQXdDTyxJQUFVQSxHQUFqQixTQUFpQkEsR0FDQyxFQUFBQyxpQkFBaEIsU0FBaUNDLEdBQy9CLE1BQXdCLFlBQWpCQSxFQUFRQyxNQUVELEVBQUFDLGNBQWhCLFNBQThCRixHQUM1QixNQUF3QixTQUFqQkEsRUFBUUMsTUFFRCxFQUFBRSxnQkFBaEIsU0FBZ0NILEdBQzlCLE1BQXdCLFdBQWpCQSxFQUFRQyxNQUVELEVBQUFHLGdCQUFoQixTQUFnQ0osR0FDOUIsTUFBd0IsV0FBakJBLEVBQVFDLE1BR0QsRUFBQUksc0JBQWhCLFNBQ0VMLEdBRUEsTUFBd0IsaUJBQWpCQSxFQUFRQyxNQUVELEVBQUFLLGNBQWhCLFNBQThCTixHQUM1QixNQUF3QixTQUFqQkEsRUFBUUMsTUFFRCxFQUFBTSxvQkFBaEIsU0FBb0NQLEdBQ2xDLE1BQXdCLGVBQWpCQSxFQUFRQyxNQXZCbkIsQ0FBaUJILE1BQU8sS0N0Q3hCVSxRQUFRQyxJQUFJLHlCQUVaLElBRUlDLEVBQ0FDLEVBSEFDLEVBQWlCLEVBQ2pCQyxFQUFvQkMsS0FBS0MsTUFLN0IsTUFBTUMsRUFBeUIsV0FDN0IsSUFDRU4sRUFBYU8sT0FBT0MsUUFBUUMsUUFBUSxDQUFFQyxLQUFNLGtCQUM1Q1YsRUFBV1csYUFBYUMsYUFBWSxLQUNsQ2QsUUFBUUMsSUFDTiw4QkFBOEJLLEtBQUtDLE1BQVFGLEdBQXFCLE9BQ2hFLFVBQVVJLE9BQU9DLFFBQVFLLGFBRXZCWCxNQUFvQixHQUN0QkksT0FHSk4sRUFBV2MsVUFBVUYsYUFBWXRCLElBQy9CLE1BQU15QixFQUFnQkMsS0FBS0MsTUFBTTNCLEdBQzdCeUIsR0F5RFYsU0FBNEJ6QixHQUN0QkYsRUFBUU0sZ0JBQWdCSixHQUMxQlEsUUFBUUMsSUFBSSw4QkFBOEJULEVBQVFBLFdBQ3pDRixFQUFRSSxjQUFjRixHQUMvQlEsUUFBUUMsSUFBSSx5QkFDSFgsRUFBUUssZ0JBQWdCSCxHQUNqQ1EsUUFBUUMsSUFBSSxpQ0FBaUNULEVBQVE0QixRQUM1QzlCLEVBQVFDLGlCQUFpQkMsSUFDbENRLFFBQVFDLElBQUksNEJBaEVSb0IsQ0FBbUJKLE1BSXZCSyxPQUFPQyxZQUFXLEtBRWhCbkIsRUFBaUIsSUFDaEIsS0FFSEosUUFBUUMsSUFBSSwrQkFBZ0NLLEtBQUtDLE1BQVFGLEdBQXFCLEtBRTlFQSxFQUFvQkMsS0FBS0MsTUFDekJpQixFQUEyQnRCLEVBQVksQ0FDckNULEtBQU0saUJBR1JnQyxFQUFXdkIsRUFBWSxNQUN2QndCLEVBQUt4QixHQUNMLE1BQU95QixNQUlYLFNBQVNELEVBQUtFLEdBQ1p6QixFQUFjbUIsT0FBT0MsWUFBVyxLQUM5QkMsRUFBMkJ0QixFQUFZLENBQ3JDVCxLQUFNLFNBRVJpQyxFQUFLRSxLQUNKLElBQXdCLElBQWhCQyxLQUFLQyxVQUlsQixTQUFTTCxFQUFXRyxFQUEyQkcsR0FDN0M1QixFQUFjbUIsT0FBT0MsWUFDbkIsS0FDRUMsRUFBMkJ0QixFQUFZLENBQ3JDVCxLQUFNLGFBQ05ELFFBQVMsMEJBQTBCYyxLQUFLQyxVQUUxQ2tCLEVBQVdHLEtBRWJHLEdBQW9CLElBQXdCLElBQWhCRixLQUFLQyxVQU1yQyxTQUFTTixFQUEyQkksRUFBMkJwQyxHQUM3RCxJQUNFb0MsRUFBS0ksWUFBWWQsS0FBS2UsVUFBVXpDLElBQ2hDLE1BQU8wQyxHQUVQLE1BREFsQyxRQUFRQyxJQUFJLHNDQUFzQ2lDLEtBQzVDQSxHQVBWMUIsSyIsImZpbGUiOiJjb250ZW50LXNjcmlwdC5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBpbnRlcmZhY2UgTWVzc2FnZSB7XG4gIHR5cGU6IHN0cmluZ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFdlbGNvbWVNZXNzYWdlIGV4dGVuZHMgTWVzc2FnZSB7XG4gIHR5cGU6ICd3ZWxjb21lJ1xuICBtZXNzYWdlOiBzdHJpbmdcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQb25nTWVzc2FnZSBleHRlbmRzIE1lc3NhZ2Uge1xuICB0eXBlOiAncG9uZydcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTb2NrZXRNZXNzYWdlIGV4dGVuZHMgTWVzc2FnZSB7XG4gIHR5cGU6ICdzb2NrZXQnXG4gIGRhdGE6IGFueVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIE1pcnJvck1lc3NhZ2UgZXh0ZW5kcyBNZXNzYWdlIHtcbiAgdHlwZTogJ21pcnJvcidcbiAgbWVzc2FnZTogYW55XG59XG5cbmV4cG9ydCB0eXBlIFNlcnZlck1lc3NhZ2UgPSBXZWxjb21lTWVzc2FnZSB8IFBvbmdNZXNzYWdlIHwgU29ja2V0TWVzc2FnZSB8IE1pcnJvck1lc3NhZ2VcblxuZXhwb3J0IGludGVyZmFjZSBTdGFydFNlc3Npb25NZXNzYWdlIGV4dGVuZHMgTWVzc2FnZSB7XG4gIHR5cGU6ICdzdGFydFNlc3Npb24nXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGluZ01lc3NhZ2UgZXh0ZW5kcyBNZXNzYWdlIHtcbiAgdHlwZTogJ3BpbmcnXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU29ja2V0U2VuZE1lc3NhZ2UgZXh0ZW5kcyBNZXNzYWdlIHtcbiAgdHlwZTogJ3NvY2tldFNlbmQnXG4gIG1lc3NhZ2U6IHN0cmluZ1xufVxuXG5leHBvcnQgdHlwZSBDb250ZW50U2NyaXB0TWVzc2FnZSA9IFN0YXJ0U2Vzc2lvbk1lc3NhZ2UgfCBQaW5nTWVzc2FnZSB8IFNvY2tldFNlbmRNZXNzYWdlXG5cbmV4cG9ydCBuYW1lc3BhY2UgTWVzc2FnZSB7XG4gIGV4cG9ydCBmdW5jdGlvbiBpc1dlbGNvbWVNZXNzYWdlKG1lc3NhZ2U6IFNlcnZlck1lc3NhZ2UpOiBtZXNzYWdlIGlzIFdlbGNvbWVNZXNzYWdlIHtcbiAgICByZXR1cm4gbWVzc2FnZS50eXBlID09PSAnd2VsY29tZSdcbiAgfVxuICBleHBvcnQgZnVuY3Rpb24gaXNQb25nTWVzc2FnZShtZXNzYWdlOiBTZXJ2ZXJNZXNzYWdlKTogbWVzc2FnZSBpcyBQb25nTWVzc2FnZSB7XG4gICAgcmV0dXJuIG1lc3NhZ2UudHlwZSA9PT0gJ3BvbmcnXG4gIH1cbiAgZXhwb3J0IGZ1bmN0aW9uIGlzU29ja2V0TWVzc2FnZShtZXNzYWdlOiBTZXJ2ZXJNZXNzYWdlKTogbWVzc2FnZSBpcyBTb2NrZXRNZXNzYWdlIHtcbiAgICByZXR1cm4gbWVzc2FnZS50eXBlID09PSAnc29ja2V0J1xuICB9XG4gIGV4cG9ydCBmdW5jdGlvbiBpc01pcnJvck1lc3NhZ2UobWVzc2FnZTogU2VydmVyTWVzc2FnZSk6IG1lc3NhZ2UgaXMgTWlycm9yTWVzc2FnZSB7XG4gICAgcmV0dXJuIG1lc3NhZ2UudHlwZSA9PT0gJ21pcnJvcidcbiAgfVxuXG4gIGV4cG9ydCBmdW5jdGlvbiBpc1N0YXJ0U2Vzc2lvbk1lc3NhZ2UoXG4gICAgbWVzc2FnZTogQ29udGVudFNjcmlwdE1lc3NhZ2VcbiAgKTogbWVzc2FnZSBpcyBTdGFydFNlc3Npb25NZXNzYWdlIHtcbiAgICByZXR1cm4gbWVzc2FnZS50eXBlID09PSAnc3RhcnRTZXNzaW9uJ1xuICB9XG4gIGV4cG9ydCBmdW5jdGlvbiBpc1BpbmdNZXNzYWdlKG1lc3NhZ2U6IENvbnRlbnRTY3JpcHRNZXNzYWdlKTogbWVzc2FnZSBpcyBQaW5nTWVzc2FnZSB7XG4gICAgcmV0dXJuIG1lc3NhZ2UudHlwZSA9PT0gJ3BpbmcnXG4gIH1cbiAgZXhwb3J0IGZ1bmN0aW9uIGlzU29ja2V0U2VuZE1lc3NhZ2UobWVzc2FnZTogQ29udGVudFNjcmlwdE1lc3NhZ2UpOiBtZXNzYWdlIGlzIFNvY2tldFNlbmRNZXNzYWdlIHtcbiAgICByZXR1cm4gbWVzc2FnZS50eXBlID09PSAnc29ja2V0U2VuZCdcbiAgfVxufVxuIiwiaW1wb3J0IHsgU2VydmVyTWVzc2FnZSwgQ29udGVudFNjcmlwdE1lc3NhZ2UsIE1lc3NhZ2UgfSBmcm9tICcuL3R5cGVzJ1xuXG5jb25zb2xlLmxvZygnSSBhbSBhIGNvbnRlbnQgc2NyaXB0JylcblxubGV0IHJlY29ubmVjdHNMZWZ0ID0gNVxubGV0IGxhc3RUaW1lQ29ubmVjdGVkID0gRGF0ZS5ub3coKVxubGV0IGNvbm5lY3Rpb246IGNocm9tZS5ydW50aW1lLlBvcnRcbmxldCBwaW5nVGltZW91dFxubGV0IHNvY2tldFBpbmdUaW1lb3V0XG5cbmNvbnN0IGNvbm5lY3RUb1NlcnZpY2VXb3JrZXIgPSBmdW5jdGlvbigpIHtcbiAgdHJ5IHtcbiAgICBjb25uZWN0aW9uID0gY2hyb21lLnJ1bnRpbWUuY29ubmVjdCh7IG5hbWU6ICdzdy1jb25uZWN0aW9uJyB9KVxuICAgIGNvbm5lY3Rpb24ub25EaXNjb25uZWN0LmFkZExpc3RlbmVyKCgpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICBgV29ya2VyIGRpc2Nvbm5lY3RlZC4gVFRMOiAkeyhEYXRlLm5vdygpIC0gbGFzdFRpbWVDb25uZWN0ZWQpIC8gMTAwMH1zYCxcbiAgICAgICAgYEVycm9yOiAke2Nocm9tZS5ydW50aW1lLmxhc3RFcnJvcn1gXG4gICAgICApXG4gICAgICBpZiAocmVjb25uZWN0c0xlZnQtLSA+PSAwKSB7XG4gICAgICAgIGNvbm5lY3RUb1NlcnZpY2VXb3JrZXIoKVxuICAgICAgfVxuICAgIH0pXG4gICAgY29ubmVjdGlvbi5vbk1lc3NhZ2UuYWRkTGlzdGVuZXIobWVzc2FnZSA9PiB7XG4gICAgICBjb25zdCBwYXJzZWRNZXNzYWdlID0gSlNPTi5wYXJzZShtZXNzYWdlKVxuICAgICAgaWYgKHBhcnNlZE1lc3NhZ2UpIHtcbiAgICAgICAgcHJvY2Vzc1BvcnRNZXNzYWdlKHBhcnNlZE1lc3NhZ2UgYXMgU2VydmVyTWVzc2FnZSlcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgLy8gbm90IGluIGFuIGVuZGxlc3MgbG9vcCwgcmVzZXRcbiAgICAgIHJlY29ubmVjdHNMZWZ0ID0gNVxuICAgIH0sIDUwMDApXG5cbiAgICBjb25zb2xlLmxvZygnQ29ubmVjdGVkIHRvIFNlcnZpY2UgV29ya2VyJywgKERhdGUubm93KCkgLSBsYXN0VGltZUNvbm5lY3RlZCkgLyAxMDAwKVxuXG4gICAgbGFzdFRpbWVDb25uZWN0ZWQgPSBEYXRlLm5vdygpXG4gICAgcG9zdE1lc3NhZ2VUb1NlcnZpY2VXb3JrZXIoY29ubmVjdGlvbiwge1xuICAgICAgdHlwZTogJ3N0YXJ0U2Vzc2lvbidcbiAgICB9KVxuXG4gICAgc29ja2V0UGluZyhjb25uZWN0aW9uLCAxNTAwKVxuICAgIHBpbmcoY29ubmVjdGlvbilcbiAgfSBjYXRjaCAoXykge31cbn1cblxuLy8gc2VuZGluZyBwaW5nIGV2ZXJ5IDEwLTIwIHNlY29uZHNcbmZ1bmN0aW9uIHBpbmcocG9ydDogY2hyb21lLnJ1bnRpbWUuUG9ydCkge1xuICBwaW5nVGltZW91dCA9IHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcbiAgICBwb3N0TWVzc2FnZVRvU2VydmljZVdvcmtlcihjb25uZWN0aW9uLCB7XG4gICAgICB0eXBlOiAncGluZydcbiAgICB9KVxuICAgIHBpbmcocG9ydClcbiAgfSwgMTAwMDAgKyBNYXRoLnJhbmRvbSgpICogMTAwMDApXG59XG5cbi8vIHNlbmRpbmcgcmFuZG9tIHN0cmluZ3MgdG8gc29ja2V0IGV2ZXJ5IDMwLTYwIHNlY29uZHNcbmZ1bmN0aW9uIHNvY2tldFBpbmcocG9ydDogY2hyb21lLnJ1bnRpbWUuUG9ydCwgdGltZW91dD86IG51bWJlcikge1xuICBwaW5nVGltZW91dCA9IHdpbmRvdy5zZXRUaW1lb3V0KFxuICAgICgpID0+IHtcbiAgICAgIHBvc3RNZXNzYWdlVG9TZXJ2aWNlV29ya2VyKGNvbm5lY3Rpb24sIHtcbiAgICAgICAgdHlwZTogJ3NvY2tldFNlbmQnLFxuICAgICAgICBtZXNzYWdlOiBgU29ycnksIGN1cnJlbnQgdGltZSBpcyAke0RhdGUubm93KCl9YFxuICAgICAgfSlcbiAgICAgIHNvY2tldFBpbmcocG9ydClcbiAgICB9LFxuICAgIHRpbWVvdXQgPyB0aW1lb3V0IDogMzAwMDAgKyBNYXRoLnJhbmRvbSgpICogMzAwMDBcbiAgKVxufVxuXG5jb25uZWN0VG9TZXJ2aWNlV29ya2VyKClcblxuZnVuY3Rpb24gcG9zdE1lc3NhZ2VUb1NlcnZpY2VXb3JrZXIocG9ydDogY2hyb21lLnJ1bnRpbWUuUG9ydCwgbWVzc2FnZTogQ29udGVudFNjcmlwdE1lc3NhZ2UpIHtcbiAgdHJ5IHtcbiAgICBwb3J0LnBvc3RNZXNzYWdlKEpTT04uc3RyaW5naWZ5KG1lc3NhZ2UpKVxuICB9IGNhdGNoIChlKSB7XG4gICAgY29uc29sZS5sb2coYENvdWxkbid0IHBvc3QgbWVzc2FnZSBkbyB0byBlcnJvcjogJHtlfWApXG4gICAgdGhyb3cgZVxuICB9XG59XG5cbmZ1bmN0aW9uIHByb2Nlc3NQb3J0TWVzc2FnZShtZXNzYWdlOiBTZXJ2ZXJNZXNzYWdlKSB7XG4gIGlmIChNZXNzYWdlLmlzTWlycm9yTWVzc2FnZShtZXNzYWdlKSkge1xuICAgIGNvbnNvbGUubG9nKGBSZWNpZXZlZCBtaXJyb3JlZCBtZXNzYWdlOiAke21lc3NhZ2UubWVzc2FnZX1gKVxuICB9IGVsc2UgaWYgKE1lc3NhZ2UuaXNQb25nTWVzc2FnZShtZXNzYWdlKSkge1xuICAgIGNvbnNvbGUubG9nKCdSZWNpZXZlZCBwb25nIG1lc3NhZ2UnKVxuICB9IGVsc2UgaWYgKE1lc3NhZ2UuaXNTb2NrZXRNZXNzYWdlKG1lc3NhZ2UpKSB7XG4gICAgY29uc29sZS5sb2coYFJlY2lldmVkIG1lc3NhZ2UgZnJvbSBzb2NrZXQ6ICR7bWVzc2FnZS5kYXRhfWApXG4gIH0gZWxzZSBpZiAoTWVzc2FnZS5pc1dlbGNvbWVNZXNzYWdlKG1lc3NhZ2UpKSB7XG4gICAgY29uc29sZS5sb2coJ1JlY2lldmVkIFdlbGNvbWUgbWVzc2FnZScpXG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=